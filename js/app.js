function bindEnent(){var t=document.getElementById("typeContanin"),e=t.getElementsByTagName("ul"),n=document.querySelectorAll(".twoBtn span"),i=document.documentElement.clientWidth,a=0,l=0,r=1,o=0,s=!0;t.addEventListener("touchstart",function(t){t.touches.length>1||(l=t.touches[0].clientX,e[o].style.transition="none",e[r].style.transition="none")},!1),t.addEventListener("touchmove",function(t){t.touches.length>1||(a=t.touches[0].clientX-l,a>0&&!s&&(e[r].style.left=a+"px",e[o].style.left=-i+a+"px"),0>a&&s&&(e[r].style.left=i+a+"px",e[o].style.left=a+"px"))},!1),t.addEventListener("touchend",function(t){var a=t.changedTouches[0].clientX-l;if(!(t.touches.length>1)){for(var u=0;u<e.length;u++)e[u].style.transition="all 0.3s ease 0s";if(!s&&a>0){s=!0,e[r].style.left=i+"px",e[o].style.left="0px";for(var u=0;u<n.length;u++)n[u].className="";n[0].className="active"}if(s&&0>a){s=!1,e[o].style.left=-i+"px",e[r].style.left="0px";for(var u=0;u<n.length;u++)n[u].className="";n[1].className="active"}}},!1)}var Util={tpl:function(t){return document.getElementById(t).innerHTML},ajax:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status||304===n.status)&&e&&e(n.responseText)},n.open("GET",t,!0),n.send()}};Vue.filter("price",function(t){return t+"元"}),Vue.filter("orignPrice",function(t){return"门市价:"+t+"元"}),Vue.filter("sales",function(t){return"已售"+t}),Vue.filter("loadMore",function(t){return"查看其他"+t+"条团购"});var Home=Vue.extend({template:Util.tpl("tpl_home"),data:function(){return{types:[{id:1,title:"美食",url:"01.png"},{id:2,title:"电影",url:"02.png"},{id:3,title:"酒店",url:"03.png"},{id:4,title:"休闲娱乐",url:"04.png"},{id:5,title:"外卖",url:"05.png"},{id:6,title:"KTV",url:"06.png"},{id:7,title:"周边游",url:"07.png"},{id:8,title:"丽人",url:"08.png"},{id:9,title:"小吃快餐",url:"09.png"},{id:10,title:"火车票",url:"10.png"}],types1:[{id:11,title:"美人",url:"11.png"},{id:12,title:"演出赛事",url:"12.png"},{id:13,title:"温泉洗浴",url:"13.png"},{id:14,title:"自助餐",url:"14.png"},{id:15,title:"亲子",url:"15.png"},{id:16,title:"代金券",url:"16.png"},{id:17,title:"生活服务",url:"17.png"},{id:18,title:"手机充值",url:"18.png"},{id:19,title:"旅游",url:"19.png"},{id:20,title:"更多分类",url:"20.png"}],ad:[],list:[]}},created:function(){this.$parent.hideSearch=!0;var t=this;Util.ajax("data/home.json",function(e){e=JSON.parse(e),0===e.errno&&(t.$set("ad",e.data.ad),t.$set("list",e.data.list),bindEnent())})}}),List=Vue.extend({template:Util.tpl("tpl_list"),data:function(){return{types:[{value:"价格排序",key:"price"},{value:"销量排序",key:"sales"},{value:"好评排序",key:"evaluate"},{value:"优惠排序",key:"discount"}],list:[],other:[]}},events:{"reload-list":function(){this.load()}},created:function(){this.$parent.hideSearch=!0,this.load()},methods:{load:function(){var t=this,e=t.$parent.query,n="";e&&2===e.length&&(n="?"+e[0]+"="+e[1]),Util.ajax("data/list.json"+n,function(e){e=JSON.parse(e),0===e.errno&&(e.data.sort(function(){return Math.random()>.5?1:-1}),t.$set("list",e.data.slice(0,3)),t.$set("other",e.data.slice(3)))})},loadMore:function(){this.list=[].concat(this.list,this.other),this.other=[]},sortBy:function(t){this.loadMore(),this.list.sort(function(e,n){return"discount"===t?n.orignPrice-n.price-(e.orignPrice-e.price):n[t]-e[t]})}}}),Product=Vue.extend({template:Util.tpl("tpl_product"),data:function(){return{product:{src:"01.jpg"}}},created:function(){var t=this;this.$parent.hideSearch=!1,Util.ajax("data/product.json",function(e){e=JSON.parse(e),0===e.errno&&t.$set("product",e.data)})}});Vue.component("login",{template:Util.tpl("tpl_login"),data:function(){return{showList:!0}},methods:{showBG:function(t){t.target.classList.add("hover")},cancelBG:function(t){t.target.classList.remove("hover")},showBar:function(t){var e=document.querySelector(".barB").getElementsByTagName("div")[0];0!=t?(e.classList.add("bar"),this.showList=!1):(this.showList=!0,e.classList.remove("bar"))}},created:function(){this.$parent.hideSearch=!1}}),Vue.component("home",Home),Vue.component("list",List),Vue.component("product",Product);var app=new Vue({el:"#app",data:{view:"",query:[],hideSearch:!0},methods:{search:function(t){var e=t.target.value;location.hash="#list/search/"+e},goBack:function(){window.history.go(-1)},login:function(){location.hash="#login"}}}),route=function(){var t=location.hash;return t=t.slice(1).replace(/^\//,""),t=t.split("/"),app.view===t[0]&&"list"===t[0]?(app.query=t.slice(1),void app.$broadcast("reload-list")):(app.query=t.slice(1),void(app.view=t[0]||"home"))};window.addEventListener("hashchange",route),window.addEventListener("load",route);